<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content=""/>
    <meta name="author" content="Mosaddek"/>
    <meta name="keyword" content="FlatLab, Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina"/>

    <title>讨论组列表</title>

    <link th:href="@{/img/favicon.html}" rel="shortcut icon"/>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/bootstrap-reset.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/font-awesome/css/font-awesome.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/owl.carousel.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/style.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/css/style-responsive.css}" rel="stylesheet" type="text/css"/>

    <style>
        td, th {
            text-align: center;
            vertical-align: middle;
        }

        .modal-dialog {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .modal-content {
            /*overflow-y: scroll; */
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        .modal-body {
            overflow-y: scroll;
            position: absolute;
            top: 55px;
            bottom: 65px;
            width: 100%;
        }

        .modal-header .close {
            margin-right: 15px;
        }

        .modal-footer {
            position: absolute;
            width: 100%;
            bottom: 0;
        }


    </style>
</head>

<body>

<div class="row">
    <div class="col-lg-12">
        <section class="panel">
            <header class="panel-heading">
                博客列表
                &nbsp;&nbsp;
            </header>
            <table class="table table-striped table-advance table-hover">
                <thead>
                <tr>
                    <th><i class="icon-group"></i> 图片</th>
                    <th><i class="icon-group"></i> 博客标题</th>
                    <!--<th><i class="icon-user"></i> 作者网名</th>-->
                    <th><i class="icon-user"></i> 博客作者</th>
                    <th><i class="icon-calendar"></i> 博客创建时间</th>
                    <th><i class="icon-edit"></i> 操作</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${blogUserDtoList.size()} eq 0">
                    <td colspan="3">没有博客信息！！</td>
                </tr>
                <tr th:each="blogs : ${blogUserDtoList}">
                    <td><img
                            th:src="${#httpServletRequest.getScheme()+'://'+#httpServletRequest.getServerName()+':'+#httpServletRequest.getServerPort()}+'/'+${blogs.blog.blogPic}"
                            style="width: 30px;height: 30px"/></td>
                    <td th:text="${blogs.blog.blogTitle}">blogTitle</td>
                    <td th:text="${blogs.userInfo.userName}">userName</td>
                    <td th:text="${blogs.blog.blogCreateTime}">blogCreateTime</td>

                    <!--<td th:text="${dto.group.groupCreateTime}">groupCreateTime</td>-->
                    <!--<td>-->
                        <!--<button class="btn btn-primary btn-xs" th:onclick="'showBlog('+${blog.blogId}+')'"><i-->
                                <!--class="icon-pencil"></i></button>-->
                    <!--</td>-->
                    <td>
                        <button class="btn btn-danger btn-xs"  th:onclick="'showBlogs('+${blogs.blog.blogId}+')'"><i>查看</i>
                        </button>
                    <button class="btn btn-danger btn-xs" th:onclick="'deleteBlogs('+${blogs.blog.blogId}+')'"><i>删除</i>
                    </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </section>
    </div>
</div>
<nav aria-label="Page navigation " style="align-content: center">
    <ul class="pagination">
        <li >
            <a th:if="${hasPrevious}==false" th:href="@{#}">上一页</a>
        </li>
        <li>
            <a th:if="${hasPrevious}==true" th:href="@{/Blogs/findAllBlogs/{num}(num=${pageNum}-1)}">上一页</a>
        </li>
        <li th:each="i:${#numbers.sequence(1,totalPages)}" th:class="${i==pageNum+1}?'page-item active':'page-item'">
            <a class="page-link" th:href="@{/Blogs/findAllBlogs/{num}(num=${i}-1)}" th:text="${i}"></a>
        </li>
        <li >
            <a  th:if="${hasNext}==false" th:href="@{#}">下一页</a>
        </li>
        <li >
            <a  th:if="${hasNext}==true" th:href="@{/Blogs/findAllBlogs/{num}(num=${pageNum}+1)}">下一页</a>
        </li>
    </ul>
</nav>

<!--查看博客-->
<div class="modal fade" id="Blog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">显示博客内容</h4>
            </div>
            <div class="modal-body">
                <form enctype="multipart/form-data" method="post">
                    <input type="hidden" id="blogId" name="blogId"/>
                    <div class="form-group">
                        <label class="control-label">图标:</label>
                        <img  id="img" width="50px" height="48px" style="border-radius: 10px"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">标题:</label>
                        <input type="text" class="form-control" id="Name" name="Name"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">作者:</label>
                        <input type="text" class="form-control" id="username" name="username"/>
                    </div>
                    <div class="form-group">
                        <label class="control-label">博客内容:</label>
                        <textarea class="form-control" id="Description" name="Description"></textarea>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>



<script type="text/javascript" th:src="@{/js/jquery-1.8.3.min.js}"></script>
<script type="text/javascript" th:src="@{/js/jquery.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/js/jquery.scrollTo.min.js}"></script>
<script type="text/javascript" th:src="@{/js/jquery.nicescroll.js}"></script>
<script type="text/javascript" th:src="@{/js/jquery.sparkline.js}"></script>
<script type="text/javascript" th:src="@{/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.js}"></script>
<script type="text/javascript" th:src="@{/js/owl.carousel.js}"></script>
<script type="text/javascript" th:src="@{/js/jquery.customSelect.min.js}"></script>
<script type="text/javascript" th:src="@{/js/sparkline-chart.js}"></script>
<script type="text/javascript" th:src="@{/js/easy-pie-chart.js}"></script>
<script type="text/javascript" th:src="@{/js/common-scripts.js}"></script>
<script type="text/javascript" th:src="@{/layer/layer.js}"></script>

</body>

<script type="text/javascript">
    function showBlogs(i) {
        $("#Blog").modal("show");
        $.ajax({
            url: "/Blogs/getBlogByBlogId" ,
            data: {blogId: i},
            type: "get",
            success:function (qqq) {
                $("#Name").val(qqq.blog.blogTitle);
                $("#username").val(qqq.userInfo.userName);
                $("#Description").val(qqq.blog.blogContent);
                $("#img").attr("src", "http://localhost:8080/" + qqq.blog.blogPic);
            }
        })
    }

    function deleteBlogs(id) {

        $.ajax({
            url: "/Blogs/deleteBlog/" + id,
            type: "post",
            success: function (data) {
                if (data.code == 1) {
                    layer.msg(data.msg, {time: 1500, icon: 1, shift: 6}, function () {
                        location.reload();
                    });
                }

            }

        })

    }


</script>

</html>
